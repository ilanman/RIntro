ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=reorder(d.m[1:137,]$Provider.Name,d.m[1:137,]$value),
fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank())+
theme(axis.ticks.x=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=reorder(d.m[1:137,]$Provider.Name,d.m[1:137,]$value),
fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')
d.m[1:137,]
ggplot(data=d.m,aes(x=d.m[1:137,]$Provider.Name,
fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank())+
theme(axis.ticks.x=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=sort(value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank())+
theme(axis.ticks.x=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=sort(value)))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank())+
theme(axis.ticks.x=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=sort(value)))+
geom_line()+
theme(axis.text.x=element_blank())+
theme(axis.ticks.x=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,color=variable,y=sort(value)))+
geom_line()
ggplot(data=d.m,aes(x=Provider.Name,color=variable,y=value))+
geom_line()
ggplot(data=d.m,aes(x=Provider.Name,group=variable,y=value))+
geom_line()
ggplot(data=d.m,aes(x=Provider.Name,group=variable,y=value,color=variable))+
geom_line()
ggplot(data=d.m,aes(x=Provider.Name,group=variable,y=value,color=variable))+
geom_line()+
theme(axis.text.x=element_blank())+
theme(axis.ticks.x=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank())+
theme(axis.ticks.x=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank())
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_point()+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value,color=variable))+
geom_point()+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,group=variable,y=value,color=variable))+
geom_point()+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=reorder(d.m[1:137,]$Provider.Name,d.m[1:137,]$Average.Covered.Charges)
,group=variable,y=value,color=variable))+
geom_point()+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
reorder(d.m[1:137,]$Provider.Name,d.m[1:137,]$Average.Covered.Charges)
d.m[1:137,]$Average.Covered.Charges
d.m[1:137,]
ggplot(data=d.m,aes(x=reorder(d.m[1:137,]$Provider.Name,d.m[1:137,]$variable)
,group=variable,y=value,color=variable))+
geom_point()+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
reorder(d.m[1:137,]$Provider.Name,d.m[1:137,]$variable)
reorder(d.m[1:137,]$Provider.Name,d.m[1:137,]$value)
ggplot(data=d.m,aes(x=reorder(d.m[1:137,]$Provider.Name,d.m[1:137,]$value)
,group=variable,y=value,color=variable))+
geom_point()+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=sort.charges,aes(y=sort.charges[,10],
x=reorder(sort.charges[,3],sort.charges[,10])))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals in New York State")+ylab("Average Hospital charge")+
scale_x_discrete(breaks=NULL)+
ggtitle("Average hospital charge for patients with Chest Pain")
sort.payment<-data[order(data[,11],decreasing=T),]
ggplot(data=sort.payment,aes(y=sort.payment[,11],
x=reorder(sort.payment[,3],sort.payment[,11])))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals in New York State")+ylab("Average Medicare payment")+
scale_x_discrete(breaks=NULL)+
ggtitle("Average Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
d.m
d.m$variable=="Average.Covered.Charges"
d.m[d.m$variable=="Average.Covered.Charges".]
d.m[d.m$variable=="Average.Covered.Charges",]
d.m[order(d.m[d.m$variable=="Average.Covered.Charges",],decreasing=T),]
d.m[order(d.m$variable=="Average.Covered.Charges",],decreasing=T),]
d.m[order(d.m[d.m$variable=="Average.Covered.Charges",],decreasing=T),]
d.m[order(d.m[d.m$variable=="Average.Covered.Charges",3],decreasing=T),]
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=,axis.ticks.x=element_blank(),
legend.title=element_blank())+
scale_x_continuous(breaks = NA)+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=,axis.ticks.x=element_blank(),
legend.title=element_blank())+
scale_x_discrete(breaks = NA)+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
scale_x_continuous(breaks = NA)
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
scale_x_continuous(breaks = NA)+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
scale_x_discrete(breaks = NA)+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
scale_x_discrete(breaks = NA)+
scale_y_discrete(breaks = NA)+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
diff<-data.frame("City"=data[,5],"Hospital"=data[,3], "Diff"=as.numeric(data[,10]-data[,11]))
diff<-diff[order(diff$Diff,decreasing=TRUE),][1:15,] ## top 15 hospitals
diff
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=90,vjust=1))+
ggtitle("Discrepancy between Medicare coverage and \nHospital payment for Chest Pain")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=90,vjust=1))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=90,vjust=0.8))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=89,vjust=0.8))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=89,vjust=0.5))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=80,vjust=0.5))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
diff<-data.frame("City"=data[,5],"Hospital"=data[,3], "Diff"=as.numeric(data[,10]-data[,11]))
diff<-diff[order(diff$Diff,decreasing=TRUE),][1:10,] ## top 10 hospitals
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.4, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=.3, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887", width=1.3, stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Discrepancy between Hospital bill and Medicare coverage")
ggplot(data=diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
scale_x_discrete(breaks = NA)+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
diff<-data.frame("City"=data[,5],"Hospital"=data[,3], "MaxDiff"=as.numeric(data[,10]-data[,11]))
diff<-diff[order(diff$MaxDiff,decreasing=TRUE),][1:10,] ## top 10 hospitals
ggplot(data=diff,aes(y=MaxDiff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
nrow(diff)
diff<-data.frame("City"=data[,5],"Hospital"=data[,3], "Diff"=as.numeric(data[,10]-data[,11]))
diff
nrow(diff)
max.diff<-diff[order(diff$Diff,decreasing=TRUE),][1:10,] ## top 10 hospitals
min.diff<-diff[order(diff$Diff,decreasing=TRUE),][(nrow(diff)-10):nrow(diff),] ## top 10 hospitals
max.diff
min.diff
ggplot(data=min.diff,aes(y=Diff,x=diff$Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
min.diff
### Max Difference
ggplot(data=max.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
min.diff
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=max.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=max.diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
min.diff
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=c(min.diff$Hospitalmin.diff$City))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=paste(min.diff$Hospital,min.diff$City))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
e")
### Min Difference
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$City)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
### Min Difference
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$City)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
### Min Difference
ggplot(data=min.diff,aes(y=Diff,x=City))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$City)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
### Min Difference
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
### Min Difference
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$City)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
### Min Difference
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(labels=min.diff$City)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
### Min Difference
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(labels=min.diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
min.diff
### Min Difference
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital,labels=min.diff$Hospital)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital,labels=min.diff$City)+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital,labels=paste(min.diff$Hospital,min.diff$City))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital,labels=paste(min.diff$Hospital,min.diff$City,sep='/n'))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital,labels=paste(min.diff$Hospital,min.diff$City,sep='\n'))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=max.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=max.diff$Hospital,labels=paste(max.diff$Hospital,max.diff$City,sep='\n'))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospitals")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital,labels=paste(min.diff$Hospital,min.diff$City,sep='\n'))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
diff
min.diff<-diff[order(diff$Diff,decreasing=FALSE),][1:10,] ## top 10 hospitals
min.diff
diff[order(diff$Diff,decreasing=TRUE),]
min.diff<-diff[order(diff$Diff,decreasing=FALSE),][1:10,] ## top 10 hospitals
min.diff
diff[order(diff$Diff,decreasing=FALSE),]$Diff>0
diff$Diff>0
diff[diff$Diff>0,]
min.diff<-diff[order(diff$Diff,decreasing=FALSE),][1:10,] ## top 10 hospitals
min.diff
ggplot(data=max.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospital - City")+ylab("Average Difference $")+
scale_x_discrete(limits=max.diff$Hospital,labels=paste(max.diff$Hospital,max.diff$City,sep='\n'))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospital - City")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital,labels=paste(min.diff$Hospital,min.diff$City,sep='\n'))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Smallest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=min.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospital\nCity")+ylab("Average Difference $")+
scale_x_discrete(limits=min.diff$Hospital,labels=paste(min.diff$Hospital,min.diff$City,sep='\n'))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Smallest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=max.diff,aes(y=Diff,x=Hospital))+
geom_bar(colour="black", fill="#DE1887",stat="identity")+
xlab("Hospital\nCity")+ylab("Average Difference $")+
scale_x_discrete(limits=max.diff$Hospital,labels=paste(max.diff$Hospital,max.diff$City,sep='\n'))+
theme(axis.text.x=element_text(angle=75,vjust=0.5))+
ggtitle("Largest discrepancies between Hospital bill and Medicare coverage")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
scale_x_discrete(breaks = NA)+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage for patients with Chest Pain")
ggplot(data=d.m,aes(x=Provider.Name,fill=variable,y=value))+
geom_bar(stat="identity",position='dodge')+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),
legend.title=element_blank())+
scale_x_discrete(breaks = NA)+
xlab("Hospitals in New York State")+ylab(NULL)+
ggtitle("Hospital charges vs. Medicare coverage\nfor patients with Chest Pain")
min(data[,11])
max(data[,11])
sort.charges<-data[order(data[,10],decreasing=T),]
ggplot(data=sort.charges,aes(y=sort.charges[,10],
x=reorder(sort.charges[,3],sort.charges[,10])))+
geom_bar(colour="black", fill="#DE1887", width=.5, stat="identity")+
xlab("Hospitals in New York State")+ylab("Average Hospital charge")+
scale_x_discrete(breaks=NULL)+
ggtitle("Average hospital charge for patients with Chest Pain")
min(data[,10])
max(data[,10])
summary(data[,10])
install_github("slidify", "ramnathv")
install_github("slidifyLibraries", "ramnathv")
library(slidify)
author('example')
slidify('index.Rmd')
library(slidify)
setwd("C:\\Users\\zhangs\\Google Drive\\R code\\Rworkshop\\")
getwd()
slidify("/Users/ilanman/Desktop/example/index.Rmd")
slidify("/Users/ilanman/Downloads/Rworkshop/index.Rmd")
slidify("/Users/ilanman/Downloads/Rworkshop/index.Rmd")
slidify("/Users/ilanman/Downloads/Rworkshop/index.Rmd")
slidify("/Users/ilanman/Downloads/Rworkshop/index.Rmd")
slidify("/Users/ilanman/Downloads/Rworkshop/index.Rmd")
author('example')
slidify('index.Rmd')
slidify('index.Rmd')
slidify('index.Rmd')
slidify('index.Rmd')
